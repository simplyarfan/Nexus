generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model agent_usage_stats {
  id               Int       @id @default(autoincrement())
  user_id          Int
  agent_id         String    @db.VarChar(100)
  usage_count      Int?      @default(0)
  total_time_spent Int?      @default(0)
  date             DateTime  @db.Date
  created_at       DateTime? @default(now()) @db.Timestamp(6)
  updated_at       DateTime? @default(now()) @db.Timestamp(6)
  users            users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, agent_id, date])
  @@index([agent_id, date(sort: Desc)], map: "idx_analytics_agent_date")
}

model candidate_notes {
  id                 Int                @id @default(autoincrement())
  candidate_id       String
  author_id          Int
  content            String
  note_type          String?            @default("general") @db.VarChar(50)
  created_at         DateTime?          @default(now()) @db.Timestamp(6)
  updated_at         DateTime?          @default(now()) @db.Timestamp(6)
  candidate_profiles candidate_profiles @relation(fields: [candidate_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  author             users              @relation(fields: [author_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([author_id], map: "idx_candidate_notes_author_id")
  @@index([candidate_id, created_at(sort: Desc)], map: "idx_candidate_notes_candidate_created")
}

model candidate_profiles {
  id                   String             @id @default(dbgenerated("(gen_random_uuid())::text"))
  email                String             @unique @db.VarChar(255)
  name                 String             @db.VarChar(255)
  phone                String?            @db.VarChar(50)
  location             String?            @db.VarChar(255)
  linkedin_url         String?
  current_company      String?            @db.VarChar(255)
  current_title        String?            @db.VarChar(255)
  years_of_experience  Int?
  education            Json?              // Array of education entries
  experience_timeline  Json?              // Work history with company, role, period, duration, achievements
  primary_skills       String[]
  certifications       String[]
  availability_status  String?            @default("available") @db.VarChar(50)
  expected_salary_min  Int?
  expected_salary_max  Int?
  notice_period_days   Int?
  created_at           DateTime?          @default(now()) @db.Timestamp(6)
  updated_at           DateTime?          @default(now()) @db.Timestamp(6)
  // Hiring status fields
  is_hired             Boolean?           @default(false)
  hired_at             DateTime?          @db.Timestamp(6)
  // User tracking
  created_by           Int?               // User who added this candidate
  // Relations
  candidate_notes      candidate_notes[]
  job_applications     job_applications[]
  employee             employees?
  creator              users?             @relation("CandidateCreator", fields: [created_by], references: [id])

  @@index([availability_status], map: "idx_candidate_profiles_availability")
  @@index([email], map: "idx_candidate_profiles_email")
  @@index([is_hired], map: "idx_candidate_profiles_is_hired")
  @@index([created_by], map: "idx_candidate_profiles_created_by")
}

model candidates {
  id                      String    @id @db.VarChar(255)
  batch_id                String    @db.VarChar(255)
  name                    String?   @db.VarChar(255)
  email                   String?   @db.VarChar(255)
  phone                   String?   @db.VarChar(50)
  location                String?   @db.VarChar(255)
  profile_json            String?
  overall_score           Int?      @default(0)
  created_at              DateTime? @default(now()) @db.Timestamp(6)
  professional_assessment String?
  experience              Json?
  education               Json?
  rank_reasoning          String?
  recommendation_level    String?
  matched_skills          String?
  missing_skills          String?
  additional_skills       String?

  @@index([batch_id], map: "idx_candidates_batch_id")
  @@index([batch_id, overall_score(sort: Desc)], map: "idx_candidates_batch_score")
  @@index([email], map: "idx_candidates_email")
  @@index([overall_score], map: "idx_candidates_overall_score")
}

model cv_batches {
  id                String    @id @db.VarChar(255)
  user_id           Int
  name              String    @db.VarChar(255)
  status            String?   @default("processing") @db.VarChar(50)
  total_resumes     Int?      @default(0)
  processed_resumes Int?      @default(0)
  created_at        DateTime? @default(now()) @db.Timestamp(6)
  updated_at        DateTime? @default(now()) @db.Timestamp(6)
  jd_requirements   String?

  @@index([user_id, status, created_at(sort: Desc)], map: "idx_batches_user_status")
  @@index([created_at], map: "idx_cv_batches_created_at")
  @@index([status], map: "idx_cv_batches_status")
  @@index([user_id], map: "idx_cv_batches_user_id")
}

model interview_reminders {
  id              String     @id @db.VarChar(255)
  interview_id    String     @db.VarChar(255)
  reminder_type   String     @db.VarChar(50)
  recipient_email String     @db.VarChar(255)
  message         String
  send_at         DateTime   @db.Timestamp(6)
  sent            Boolean?   @default(false)
  sent_at         DateTime?  @db.Timestamp(6)
  created_at      DateTime?  @default(now()) @db.Timestamp(6)
  interviews      interviews @relation(fields: [interview_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([interview_id], map: "idx_interview_reminders_interview_id")
  @@index([send_at], map: "idx_interview_reminders_send_at")
  @@index([sent], map: "idx_interview_reminders_sent")
  @@index([send_at, sent], map: "idx_reminders_send_at_sent")
}

model interviews {
  id                  String                @id @db.VarChar(255)
  candidate_id        String                @db.VarChar(255)
  candidate_name      String                @db.VarChar(255)
  candidate_email     String                @db.VarChar(255)
  job_title           String                @db.VarChar(255)
  interview_type      String?               @default("technical") @db.VarChar(50)
  status              String?               @default("scheduled") @db.VarChar(50)
  scheduled_time      DateTime?             @db.Timestamp(6)
  duration            Int?                  @default(60)
  location            String?               @default("Video Call") @db.VarChar(255)
  meeting_link        String?
  calendly_link       String?
  google_form_link    String?
  panel_members       String?
  generated_questions String?
  notes               String?
  scheduled_by        Int
  created_at          DateTime?             @default(now()) @db.Timestamp(6)
  updated_at          DateTime?             @default(now()) @db.Timestamp(6)
  platform            String?               @db.VarChar(100)
  outcome             String?               @db.VarChar(50)
  scheduled_at        DateTime?             @db.Timestamp(6)
  cv_file_path        String?
  google_event_id     String?               @db.VarChar(255)
  teams_meeting_id    String?               @db.VarChar(255)
  cc_emails              String?
  bcc_emails             String?
  rejection_email_sent   Boolean?              @default(false)
  rejection_email_sent_at DateTime?            @db.Timestamp(6)
  interview_reminders interview_reminders[]
  scheduler           users                 @relation("InterviewScheduler", fields: [scheduled_by], references: [id])

  @@index([candidate_email], map: "idx_interviews_candidate_email")
  @@index([candidate_id], map: "idx_interviews_candidate_id")
  @@index([google_event_id], map: "idx_interviews_google_event_id")
  @@index([teams_meeting_id], map: "idx_interviews_teams_meeting_id")
  @@index([scheduled_at], map: "idx_interviews_scheduled_at")
  @@index([scheduled_by], map: "idx_interviews_scheduled_by")
  @@index([scheduled_time], map: "idx_interviews_scheduled_time")
  @@index([scheduled_time, status], map: "idx_interviews_scheduled_time_status")
  @@index([status], map: "idx_interviews_status")
}

model job_applications {
  id                     String             @id @default(dbgenerated("(gen_random_uuid())::text"))
  candidate_id           String
  job_position_id        String
  status                 String?            @default("applied") @db.VarChar(50)
  current_stage          String?            @db.VarChar(100)
  stage_number           Int?               @default(1)
  position_match_score   Int?
  performance_score      Int?
  potential_score        Int?
  // Enhanced AI Match Scoring Fields
  skills_match_score     Int?
  experience_match_score Int?
  location_match_score   Int?
  salary_match_score     Int?
  context_match_score    Int?
  match_reasoning        String?
  match_strengths        String[]
  match_concerns         String[]
  match_category         String?            @db.VarChar(20)
  auto_matched           Boolean?           @default(false)
  // Detailed Skill Match Breakdown
  matched_required_skills   String[]
  unmatched_required_skills String[]
  matched_preferred_skills  String[]
  unmatched_preferred_skills String[]
  candidate_skills_used     String[]         // Which candidate skills were matched
  // End Enhanced Fields
  cover_letter           String?
  applied_via            String?            @db.VarChar(100)
  referrer_name          String?            @db.VarChar(255)
  interview_ids          String[]
  total_interviews       Int?               @default(0)
  interviews_completed   Int?               @default(0)
  applied_at             DateTime?          @default(now()) @db.Timestamp(6)
  last_activity_at       DateTime?          @default(now()) @db.Timestamp(6)
  rejected_at            DateTime?          @db.Timestamp(6)
  offer_sent_at          DateTime?          @db.Timestamp(6)
  offer_accepted_at      DateTime?          @db.Timestamp(6)
  recruiter_notes        String?
  rejection_reason       String?
  created_at             DateTime?          @default(now()) @db.Timestamp(6)
  updated_at             DateTime?          @default(now()) @db.Timestamp(6)
  candidate_profiles     candidate_profiles @relation(fields: [candidate_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  job_positions          job_positions      @relation(fields: [job_position_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([candidate_id, job_position_id])
  @@index([candidate_id], map: "idx_job_applications_candidate")
  @@index([job_position_id], map: "idx_job_applications_position")
  @@index([position_match_score(sort: Desc)], map: "idx_job_applications_score")
  @@index([match_category], map: "idx_job_applications_category")
  @@index([auto_matched], map: "idx_job_applications_auto_matched")
}

model job_positions {
  id                String             @id @default(dbgenerated("(gen_random_uuid())::text"))
  title             String             @db.VarChar(255)
  department        String             @db.VarChar(100)
  location          String?            @db.VarChar(255)
  employment_type   String?            @db.VarChar(50)
  experience_level  String?            @db.VarChar(50)
  salary_range_min  Int?
  salary_range_max  Int?
  currency          String?            @default("USD") @db.VarChar(10)
  description       String?
  requirements      Json?
  responsibilities  Json?
  required_skills   String[]
  preferred_skills  String[]
  benefits          Json?
  status            String?            @default("open") @db.VarChar(50)
  hiring_manager_id Int?
  openings_count    Int?               @default(1)
  remote_policy     String?            @db.VarChar(50)
  created_by        Int?
  created_at        DateTime?          @default(now()) @db.Timestamp(6)
  updated_at        DateTime?          @default(now()) @db.Timestamp(6)
  filled_at         DateTime?          @db.Timestamp(6)
  job_applications  job_applications[]
  creator           users?             @relation("JobPositionCreator", fields: [created_by], references: [id])

  @@index([status], map: "idx_job_positions_status")
  @@index([department], map: "idx_job_positions_department")
  @@index([created_by], map: "idx_job_positions_created_by")
  @@index([status, created_at(sort: Desc)], map: "idx_job_positions_status_created")
}

model jobs {
  id                String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id           Int
  title             String    @db.VarChar(255)
  description       String
  requirements_json Json
  embedding         String?
  created_at        DateTime? @default(now()) @db.Timestamp(6)
  users             users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model notifications {
  id         Int       @id @default(autoincrement())
  user_id    Int
  type       String    @db.VarChar(50)
  title      String    @db.VarChar(255)
  message    String
  metadata   Json?     @db.Json
  is_read    Boolean?  @default(false)
  read_at    DateTime? @db.Timestamp(6)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  users      users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([user_id], map: "idx_notifications_user_id")
  @@index([user_id, is_read], map: "idx_notifications_user_read")
  @@index([created_at(sort: Desc)], map: "idx_notifications_created_at")
}

model resume_entities {
  id               String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  resume_id        String      @db.Uuid
  entity_type      String      @db.VarChar(50)
  entity_value     String
  confidence_score Float?      @default(0.0)
  start_offset     Int?
  end_offset       Int?
  spacy_label      String?     @db.VarChar(50)
  context_window   String?
  created_at       DateTime?   @default(now()) @db.Timestamp(6)
  resumes_raw      resumes_raw @relation(fields: [resume_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model resumes_raw {
  id                String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id           Int
  filename          String            @db.VarChar(255)
  file_url          String
  file_size         Int?
  file_type         String?           @db.VarChar(50)
  upload_timestamp  DateTime?         @default(now()) @db.Timestamp(6)
  raw_text          String?
  processing_status String?           @default("pending") @db.VarChar(50)
  resume_entities   resume_entities[]
  users             users             @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model support_tickets {
  id                                       Int               @id @default(autoincrement())
  user_id                                  Int
  subject                                  String            @db.VarChar(255)
  description                              String
  status                                   String?           @default("open") @db.VarChar(50)
  priority                                 String?           @default("medium") @db.VarChar(20)
  category                                 String?           @default("general") @db.VarChar(50)
  assigned_to                              Int?
  resolution                               String?
  resolved_at                              DateTime?         @db.Timestamp(6)
  created_at                               DateTime?         @default(now()) @db.Timestamp(6)
  updated_at                               DateTime?         @default(now()) @db.Timestamp(6)
  users_support_tickets_assigned_toTousers users?            @relation("support_tickets_assigned_toTousers", fields: [assigned_to], references: [id], onUpdate: NoAction)
  users_support_tickets_user_idTousers     users             @relation("support_tickets_user_idTousers", fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  ticket_comments                          ticket_comments[]

  @@index([created_at], map: "idx_support_tickets_created_at")
  @@index([priority], map: "idx_support_tickets_priority")
  @@index([status], map: "idx_support_tickets_status")
  @@index([user_id], map: "idx_support_tickets_user_id")
  @@index([priority, status], map: "idx_tickets_priority_status")
  @@index([status, created_at(sort: Desc)], map: "idx_tickets_status_created")
  @@index([user_id, status], map: "idx_tickets_user_status")
}

model system_settings {
  id          Int       @id @default(autoincrement())
  key         String    @unique @db.VarChar(100)
  value       String
  description String?
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @db.Timestamp(6)
}

model ticket_comments {
  id              Int             @id @default(autoincrement())
  ticket_id       Int
  user_id         Int
  comment         String
  is_internal     Boolean?        @default(false)
  created_at      DateTime?       @default(now()) @db.Timestamp(6)
  support_tickets support_tickets @relation(fields: [ticket_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users           users           @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([ticket_id, created_at], map: "idx_comments_ticket_created")
}

model user_analytics {
  id         Int       @id @default(autoincrement())
  user_id    Int?
  action     String    @db.VarChar(100)
  agent_id   String?   @db.VarChar(100)
  metadata   Json?
  ip_address String?   @db.VarChar(45)
  user_agent String?
  created_at DateTime? @default(now()) @db.Timestamp(6)
  users      users?    @relation(fields: [user_id], references: [id], onUpdate: NoAction)

  @@index([user_id, action, created_at(sort: Desc)], map: "idx_analytics_user_action_date")
}

model user_preferences {
  id                    Int       @id @default(autoincrement())
  user_id               Int       @unique
  theme                 String?   @default("light") @db.VarChar(20)
  notifications_email   Boolean?  @default(true)
  notifications_browser Boolean?  @default(true)
  language              String?   @default("en") @db.VarChar(10)
  timezone              String?   @default("UTC") @db.VarChar(50)
  created_at            DateTime? @default(now()) @db.Timestamp(6)
  updated_at            DateTime? @default(now()) @db.Timestamp(6)
  date_format           String?   @default("MM/DD/YYYY") @db.VarChar(20)
  users                 users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model user_sessions {
  id            Int       @id @default(autoincrement())
  user_id       Int
  session_token String    @unique @db.VarChar(255)
  refresh_token String    @unique @db.VarChar(255)
  expires_at    DateTime  @db.Timestamp(6)
  ip_address    String?   @db.VarChar(45)
  user_agent    String?
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  users         users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([expires_at], map: "idx_user_sessions_expires_at")
  @@index([session_token], map: "idx_user_sessions_session_token")
  @@index([user_id], map: "idx_user_sessions_user_id")
  @@index([user_id, session_token], map: "idx_user_sessions_user_token")
}

model users {
  id                                                 Int                 @id @default(autoincrement())
  email                                              String              @unique(map: "idx_users_email") @db.VarChar(255)
  password_hash                                      String              @db.VarChar(255)
  first_name                                         String              @db.VarChar(100)
  last_name                                          String              @db.VarChar(100)
  role                                               String?             @default("user") @db.VarChar(50)
  department                                         String?             @db.VarChar(100)
  job_title                                          String?             @db.VarChar(100)
  is_active                                          Boolean?            @default(true)
  is_verified                                        Boolean?            @default(false)
  verification_token                                 String?             @db.VarChar(255)
  verification_expiry                                DateTime?           @db.Timestamp(6)
  reset_token                                        String?             @db.VarChar(255)
  reset_token_expiry                                 DateTime?           @db.Timestamp(6)
  last_login                                         DateTime?           @db.Timestamp(6)
  created_at                                         DateTime?           @default(now()) @db.Timestamp(6)
  updated_at                                         DateTime?           @default(now()) @db.Timestamp(6)
  failed_login_attempts                              Int?                @default(0)
  account_locked_until                               DateTime?           @db.Timestamp(6)
  outlook_access_token                               String?
  outlook_refresh_token                              String?
  outlook_token_expires_at                           DateTime?           @db.Timestamp(6)
  outlook_email                                      String?             @db.VarChar(255)
  two_factor_enabled                                 Boolean?            @default(false)
  two_factor_secret                                  String?             @db.VarChar(255)
  two_factor_code                                    String?             @db.VarChar(10)
  two_factor_code_expires_at                         DateTime?           @db.Timestamp(6)
  google_access_token                                String?
  google_refresh_token                               String?
  google_token_expires_at                            DateTime?           @db.Timestamp(6)
  outlook_pkce_verifier                              String?
  phone                                              String?             @db.VarChar(50)
  profile_picture_url                                String?
  bio                                                String?
  timezone                                           String?             @default("Asia/Riyadh") @db.VarChar(100)
  date_format                                        String?             @default("MM/DD/YYYY") @db.VarChar(20)
  agent_usage_stats                                  agent_usage_stats[]
  candidate_notes                                    candidate_notes[]
  jobs                                               jobs[]
  notifications                                      notifications[]
  resumes_raw                                        resumes_raw[]
  support_tickets_support_tickets_assigned_toTousers support_tickets[]   @relation("support_tickets_assigned_toTousers")
  support_tickets_support_tickets_user_idTousers     support_tickets[]   @relation("support_tickets_user_idTousers")
  ticket_comments                                    ticket_comments[]
  user_analytics                                     user_analytics[]
  user_preferences                                   user_preferences?
  user_sessions                                      user_sessions[]
  // HR Onboarding relations
  employee_as_user                                   employees?          @relation("EmployeeUser")
  employees_created                                  employees[]         @relation("EmployeeCreator")
  onboarding_assigned                                onboarding[]        @relation("OnboardingAssignee")
  onboarding_buddy                                   onboarding[]        @relation("OnboardingBuddy")
  // HR Recruitment tracking relations
  candidates_created                                 candidate_profiles[] @relation("CandidateCreator")
  job_positions_created                              job_positions[]     @relation("JobPositionCreator")
  interviews_scheduled                               interviews[]        @relation("InterviewScheduler")

  @@index([created_at], map: "idx_users_created_at")
  @@index([department], map: "idx_users_department")
  @@index([is_active], map: "idx_users_is_active")
  @@index([role], map: "idx_users_role")
}

// =====================================================
// HR ONBOARDING SYSTEM TABLES
// =====================================================

model employees {
  id                          Int                @id @default(autoincrement())
  employee_id                 String             @unique @db.VarChar(50) // EMP-2024-001

  // Link to candidate
  candidate_profile_id        String             @unique
  interview_id                String?            @db.VarChar(255)

  // Basic Info (from candidate_profiles)
  email                       String             @unique @db.VarChar(255)
  first_name                  String             @db.VarChar(100)
  last_name                   String             @db.VarChar(100)
  phone                       String?            @db.VarChar(50)

  // Personal Info (from Google Sheets Form)
  nationality                 String?            @db.VarChar(100)
  city                        String?            @db.VarChar(100) // Location (City)
  whatsapp_number             String?            @db.VarChar(50)
  current_residency           String?            @db.VarChar(100)
  marital_status              String?            @db.VarChar(50)
  number_of_dependents        Int?
  total_experience            String?            @db.VarChar(100)
  education                   String?
  certifications              String?
  current_salary              String?            @db.VarChar(100)
  expected_salary             String?            @db.VarChar(100)
  notice_period               String?            @db.VarChar(100)
  date_of_joining             DateTime?          @db.Date

  // Work Preferences (from Google Sheets Form)
  open_to_banking_insurance   Boolean?           @default(false)
  open_to_multiple_technologies Boolean?         @default(false)

  // Saudi-specific (Iqama - from Google Sheets Form)
  iqama_expiry                DateTime?          @db.Date
  iqama_profession            String?            @db.VarChar(255)

  // Employment Info
  job_title                   String             @db.VarChar(255)
  department                  String             @db.VarChar(100)
  employment_type             String?            @default("full-time") @db.VarChar(50) // full-time, part-time, contract
  start_date                  DateTime?          @db.Date
  offered_salary              Decimal?           @db.Decimal(15, 2)
  salary_currency             String?            @default("SAR") @db.VarChar(10) // SAR, USD, AED, EUR, GBP, PKR, INR

  // Documents (JSON array of uploaded docs)
  documents                   Json?              // [{type: 'id', url: '...', uploaded_at: '...'}]

  // Status
  status                      String?            @default("pending") @db.VarChar(50) // pending, onboarding, active, inactive

  // System user account (created after onboarding complete)
  user_id                     Int?               @unique

  // Metadata
  created_at                  DateTime?          @default(now()) @db.Timestamp(6)
  updated_at                  DateTime?          @default(now()) @db.Timestamp(6)
  created_by                  Int                // User who initiated the hire

  // Relations
  candidate_profile           candidate_profiles @relation(fields: [candidate_profile_id], references: [id])
  user                        users?             @relation("EmployeeUser", fields: [user_id], references: [id])
  creator                     users              @relation("EmployeeCreator", fields: [created_by], references: [id])
  onboarding                  onboarding?

  @@index([status], map: "idx_employees_status")
  @@index([department], map: "idx_employees_department")
  @@index([created_by], map: "idx_employees_created_by")
  @@index([created_at(sort: Desc)], map: "idx_employees_created_at")
}

model onboarding {
  id                          Int                @id @default(autoincrement())
  employee_id                 Int                @unique

  // Status
  status                      String?            @default("not_started") @db.VarChar(50) // not_started, in_progress, completed
  started_at                  DateTime?          @db.Timestamp(6)
  completed_at                DateTime?          @db.Timestamp(6)

  // Checklist Items (JSON for flexibility)
  checklist                   Json?              // Array of {id, title, category, completed, completed_at, completed_by}

  // Email Tracking
  welcome_email_sent          Boolean?           @default(false)
  welcome_email_sent_at       DateTime?          @db.Timestamp(6)
  offer_letter_sent           Boolean?           @default(false)
  offer_letter_sent_at        DateTime?          @db.Timestamp(6)
  document_request_sent       Boolean?           @default(false)
  document_request_sent_at    DateTime?          @db.Timestamp(6)
  first_day_info_sent         Boolean?           @default(false)
  first_day_info_sent_at      DateTime?          @db.Timestamp(6)

  // Assignment
  assigned_to                 Int?               // HR user responsible
  buddy_id                    Int?               // Assigned buddy/mentor

  // Notes
  notes                       String?

  // Metadata
  created_at                  DateTime?          @default(now()) @db.Timestamp(6)
  updated_at                  DateTime?          @default(now()) @db.Timestamp(6)

  // Relations
  employee                    employees          @relation(fields: [employee_id], references: [id], onDelete: Cascade)
  assignee                    users?             @relation("OnboardingAssignee", fields: [assigned_to], references: [id])
  buddy                       users?             @relation("OnboardingBuddy", fields: [buddy_id], references: [id])

  @@index([status], map: "idx_onboarding_status")
  @@index([assigned_to], map: "idx_onboarding_assigned_to")
  @@index([created_at(sort: Desc)], map: "idx_onboarding_created_at")
}
